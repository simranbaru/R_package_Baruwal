<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Baruwal R Package • BaruwalRPackage</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Baruwal R Package">
<meta property="og:description" content="BaruwalRPackage">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BaruwalRPackage</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Baruwal_R_Package_Tutorial.html">Baruwal R Package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Baruwal R Package</h1>
                        <h4 data-toc-skip class="author">Simran Baruwal</h4>
            
            <h4 data-toc-skip class="date">12/2/2021</h4>
      
      
      <div class="hidden name"><code>Baruwal_R_Package_Tutorial.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="data-simulation">Data Simulation<a class="anchor" aria-label="anchor" href="#data-simulation"></a>
</h2>
<p>This tutorial uses the function from package FossilSim to simulate datasets from posterior distribution. We quantify some characteristics of both the simulated and emperical(origin time) datasets using test statistics, here, mean and standard deviation. The goal is to check the model adequacy.</p>
<p>You might need to install these packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Installing package into '/tmp/RtmpuamUV7/temp_libpathed490b803a'</span>
<span class="co">## (as 'lib' is unspecified)</span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggplot2"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Installing package into '/tmp/RtmpuamUV7/temp_libpathed490b803a'</span>
<span class="co">## (as 'lib' is unspecified)</span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## ── <span style="font-weight: bold;">Attaching packages</span> ─────────────────────────────────────── tidyverse 1.3.1 ──</span></code></pre>
<pre><code><span class="co">## <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">ggplot2</span> 3.3.5     <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">purrr  </span> 0.3.4</span>
<span class="co">## <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">tibble </span> 3.1.6     <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">dplyr  </span> 1.0.7</span>
<span class="co">## <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">tidyr  </span> 1.1.4     <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">stringr</span> 1.4.0</span>
<span class="co">## <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">readr  </span> 2.0.2     <span style="color: #00BB00;">✓</span> <span style="color: #0000BB;">forcats</span> 0.5.1</span></code></pre>
<pre><code><span class="co">## ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">## <span style="color: #BB0000;">x</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span>
<span class="co">## <span style="color: #BB0000;">x</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Installing package into '/tmp/RtmpuamUV7/temp_libpathed490b803a'</span>
<span class="co">## (as 'lib' is unspecified)</span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Loading required package: usethis</span></code></pre>
<p>You need to install FossilSim R package for this package to run. # FossilSim is used for simulating trees directly from a fossilized-birth death process using the sim.fbd function.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"FossilSim"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Installing package into '/tmp/RtmpuamUV7/temp_libpathed490b803a'</span>
<span class="co">## (as 'lib' is unspecified)</span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FossilSim</span><span class="op">)</span></code></pre></div>
<p>Now, we install my R package:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"simranbaru/R_Package_Baruwal"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Using github PAT from envvar GITHUB_PAT</span></code></pre>
<pre><code><span class="co">## Downloading GitHub repo simranbaru/R_Package_Baruwal@HEAD</span></code></pre>
<pre><code>##   
   checking for file ‘/tmp/RtmplIBEAN/remotes40259e2f35c/simranbaru-R_package_Baruwal-39cda19/DESCRIPTION’ ...
  
 [32m✓ [39m   [38;5;247mchecking for file ‘/tmp/RtmplIBEAN/remotes40259e2f35c/simranbaru-R_package_Baruwal-39cda19/DESCRIPTION’ [39m [36m [39m
## 
  
 [38;5;247m─ [39m [38;5;247m   [39m [38;5;247mpreparing ‘BaruwalRPackage’: [39m [36m [39m
## 
  
   checking DESCRIPTION meta-information ...
  
 [32m✓ [39m   [38;5;247mchecking DESCRIPTION meta-information [39m [36m [39m
## 
  
 [38;5;247m─ [39m [38;5;247m   [39m [38;5;247mchecking for LF line-endings in source and make files and shell scripts [39m [36m [39m
## 
  
 [38;5;247m─ [39m [38;5;247m   [39m [38;5;247mchecking for empty or unneeded directories [39m [36m [39m
##  [38;5;247m─ [39m [38;5;247m   [39m [38;5;247mlooking to see if a ‘data/datalist’ file should be added [39m [36m [39m
## 
  
 [38;5;247m─ [39m [38;5;247m   [39m [38;5;247mbuilding ‘BaruwalRPackage_0.0.0.9000.tar.gz’ [39m [36m [39m
## 
  
   
## </code></pre>
<pre><code><span class="co">## Installing package into '/tmp/RtmpuamUV7/temp_libpathed490b803a'</span>
<span class="co">## (as 'lib' is unspecified)</span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">BaruwalRPackage</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #00BBBB;">ℹ</span> Loading <span style="color: #0000BB;">BaruwalRPackage</span></span></code></pre>
<p>Let us download some data for our package:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/simranbaru/R_package_Baruwal/master/data/ants_timevary.log"</span>, destfile <span class="op">=</span> <span class="st">"/cloud/project/vignettes/ants_timevary.log"</span><span class="op">)</span></code></pre></div>
<p>Lets load our data and get started:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ants</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span><span class="st">"/cloud/project/vignettes/ants_timevary.log"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">20</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">1557</span></span></code></pre>
<pre><code><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">## <span style="font-weight: bold;">Delimiter:</span> "\t"</span>
<span class="co">## <span style="color: #00BB00;">dbl</span> (1557): Iteration, Posterior, Likelihood, Prior, alpha_cytb[1], alpha_cy...</span></code></pre>
<pre><code><span class="co">## </span>
<span class="co">## <span style="color: #00BBBB;">ℹ</span> Use <span style="color: #262626; background-color: #DADADA;">`spec()`</span> to retrieve the full column specification for this data.</span>
<span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set <span style="color: #262626; background-color: #DADADA;">`show_col_types = FALSE`</span> to quiet this message.</span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ants</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 20 × 1,557</span></span>
<span class="co">##    Iteration Posterior Likelihood  Prior `alpha_cytb[1]` `alpha_cytb[2]`</span>
<span class="co">##        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">## <span style="color: #BCBCBC;"> 1</span>         0  -<span style="color: #BB0000; text-decoration: underline;">869</span><span style="color: #BB0000;">910.</span>   -<span style="color: #BB0000; text-decoration: underline;">866</span><span style="color: #BB0000;">709.</span> -<span style="color: #BB0000; text-decoration: underline;">3</span><span style="color: #BB0000;">200.</span>           0.792           0.256</span>
<span class="co">## <span style="color: #BCBCBC;"> 2</span>        10  -<span style="color: #BB0000; text-decoration: underline;">665</span><span style="color: #BB0000;">628.</span>   -<span style="color: #BB0000; text-decoration: underline;">662</span><span style="color: #BB0000;">948.</span> -<span style="color: #BB0000; text-decoration: underline;">2</span><span style="color: #BB0000;">679.</span>           0.238           0.245</span>
<span class="co">## <span style="color: #BCBCBC;"> 3</span>        20  -<span style="color: #BB0000; text-decoration: underline;">645</span><span style="color: #BB0000;">766.</span>   -<span style="color: #BB0000; text-decoration: underline;">644</span><span style="color: #BB0000;">125</span>  -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">640.</span>           0.152           0.270</span>
<span class="co">## <span style="color: #BCBCBC;"> 4</span>        30  -<span style="color: #BB0000; text-decoration: underline;">641</span><span style="color: #BB0000;">394.</span>   -<span style="color: #BB0000; text-decoration: underline;">640</span><span style="color: #BB0000;">495.</span>  -<span style="color: #BB0000;">899.</span>           0.154           0.269</span>
<span class="co">## <span style="color: #BCBCBC;"> 5</span>        40  -<span style="color: #BB0000; text-decoration: underline;">639</span><span style="color: #BB0000;">094.</span>   -<span style="color: #BB0000; text-decoration: underline;">638</span><span style="color: #BB0000;">700.</span>  -<span style="color: #BB0000;">394.</span>           0.159           0.279</span>
<span class="co">## <span style="color: #BCBCBC;"> 6</span>        50  -<span style="color: #BB0000; text-decoration: underline;">638</span><span style="color: #BB0000;">528.</span>   -<span style="color: #BB0000; text-decoration: underline;">638</span><span style="color: #BB0000;">129.</span>  -<span style="color: #BB0000;">399.</span>           0.149           0.276</span>
<span class="co">## <span style="color: #BCBCBC;"> 7</span>        60  -<span style="color: #BB0000; text-decoration: underline;">638</span><span style="color: #BB0000;">197.</span>   -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">788.</span>  -<span style="color: #BB0000;">409.</span>           0.158           0.275</span>
<span class="co">## <span style="color: #BCBCBC;"> 8</span>        70  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">743.</span>   -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">260.</span>  -<span style="color: #BB0000;">483.</span>           0.151           0.281</span>
<span class="co">## <span style="color: #BCBCBC;"> 9</span>        80  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">465.</span>   -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">026</span>   -<span style="color: #BB0000;">439.</span>           0.148           0.276</span>
<span class="co">## <span style="color: #BCBCBC;">10</span>        90  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">443.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">947.</span>  -<span style="color: #BB0000;">496.</span>           0.154           0.280</span>
<span class="co">## <span style="color: #BCBCBC;">11</span>       100  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">373.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">928.</span>  -<span style="color: #BB0000;">445.</span>           0.152           0.278</span>
<span class="co">## <span style="color: #BCBCBC;">12</span>       110  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">419.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">925.</span>  -<span style="color: #BB0000;">494.</span>           0.150           0.273</span>
<span class="co">## <span style="color: #BCBCBC;">13</span>       120  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">350.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">879.</span>  -<span style="color: #BB0000;">471.</span>           0.151           0.268</span>
<span class="co">## <span style="color: #BCBCBC;">14</span>       130  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">351.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">859.</span>  -<span style="color: #BB0000;">493.</span>           0.152           0.277</span>
<span class="co">## <span style="color: #BCBCBC;">15</span>       140  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">294.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">851.</span>  -<span style="color: #BB0000;">443.</span>           0.150           0.282</span>
<span class="co">## <span style="color: #BCBCBC;">16</span>       150  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">245.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">841.</span>  -<span style="color: #BB0000;">404.</span>           0.149           0.282</span>
<span class="co">## <span style="color: #BCBCBC;">17</span>       160  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">267.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">829.</span>  -<span style="color: #BB0000;">437.</span>           0.153           0.273</span>
<span class="co">## <span style="color: #BCBCBC;">18</span>       170  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">314.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">824.</span>  -<span style="color: #BB0000;">490.</span>           0.148           0.269</span>
<span class="co">## <span style="color: #BCBCBC;">19</span>       180  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">325.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">824.</span>  -<span style="color: #BB0000;">501.</span>           0.151           0.287</span>
<span class="co">## <span style="color: #BCBCBC;">20</span>       190  -<span style="color: #BB0000; text-decoration: underline;">637</span><span style="color: #BB0000;">318.</span>   -<span style="color: #BB0000; text-decoration: underline;">636</span><span style="color: #BB0000;">811.</span>  -<span style="color: #BB0000;">507.</span>           0.151           0.273</span>
<span class="co">## <span style="color: #949494;"># … with 1,551 more variables: alpha_cytb[3] &lt;dbl&gt;, alpha_cytb[4] &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   alpha_cytb[5] &lt;dbl&gt;, alpha_cytb[6] &lt;dbl&gt;, alpha_cytb[7] &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   alpha_cytb[8] &lt;dbl&gt;, alpha_cytb[9] &lt;dbl&gt;, branch_rates[1] &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   branch_rates[2] &lt;dbl&gt;, branch_rates[3] &lt;dbl&gt;, branch_rates[4] &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   branch_rates[5] &lt;dbl&gt;, branch_rates[6] &lt;dbl&gt;, branch_rates[7] &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   branch_rates[8] &lt;dbl&gt;, branch_rates[9] &lt;dbl&gt;, branch_rates[10] &lt;dbl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   branch_rates[11] &lt;dbl&gt;, branch_rates[12] &lt;dbl&gt;, branch_rates[13] &lt;dbl&gt;, …</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="va">ants</span><span class="op">$</span><span class="va">speciation_rate</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">ants</span><span class="op">$</span><span class="va">extinction_rate</span>
<span class="va">psi</span> <span class="op">&lt;-</span> <span class="va">ants</span><span class="op">$</span><span class="va">psi</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="function-simulation">Function: Simulation<a class="anchor" aria-label="anchor" href="#function-simulation"></a>
</h2>
<p>This function simulates trees while conditioning on the number of sampled extant taxa using sim.fbd.taxa function. It requires the fossil sampling rate parameter psi as an argument.</p>
<p>#Working example:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/simulation.html">simulation</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span>, numbsim<span class="op">=</span><span class="fl">1</span>, lambda <span class="op">=</span> <span class="fl">0.01806175</span>, mu <span class="op">=</span> <span class="fl">1.078013e-03</span> , psi <span class="op">=</span> <span class="fl">5.172419e-02</span>, frac <span class="op">=</span> <span class="fl">.01</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 2938 tips and 2937 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t236_2, t45_1, t493_3, t375_1, t578_3, t121_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span></code></pre>
<p>Now, lets simulate the data creating a vector using the function simulation:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">i</span> <span class="op">=</span> <span class="fl">1</span>
<span class="va">trees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">while</span> <span class="op">(</span><span class="va">i</span> <span class="op">&lt;=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">{</span>
<span class="va">trees</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">BaruwalRPackage</span><span class="fu">::</span><span class="fu"><a href="../reference/simulation.html">simulation</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span>, numbsim<span class="op">=</span><span class="fl">1</span>, <span class="va">lambda</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">mu</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">psi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, frac <span class="op">=</span> <span class="fl">.01</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trees</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
<span class="va">i</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">+</span> <span class="fl">1</span>
<span class="op">}</span></code></pre></div>
<pre><code><span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 3221 tips and 3220 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t12_3, t835_1, t513_3, t698_3, t725_3, t653_3, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 1226 tips and 1225 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t459_2, t686_1, t254_1, t619_2, t140_2, t823_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 408 tips and 407 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t318_2, t292_1, t271_1, t362_1, t615_1, t448_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 108 tips and 107 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t518_2, t909_1, t985_1, t85_1, t951_1, t248_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 18 tips and 17 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t539_1, t308_1, t709_1, t437_1, t477_1, t14_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 13 tips and 12 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t255_1, t46_1, t714_1, t824_1, t648_1, t676_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 12 tips and 11 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t902_1, t759_1, t459_1, t865_1, t957_1, t147_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 10 tips and 9 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t819_1, t326_1, t717_1, t454_1, t387_1, t575_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 12 tips and 11 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t580_1, t743_1, t131_1, t320_1, t706_1, t123_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 14 tips and 13 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t205_1, t800_1, t881_1, t927_1, t406_1, t647_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 12 tips and 11 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t167_1, t362_1, t910_1, t84_1, t709_1, t308_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 12 tips and 11 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t325_1, t998_1, t174_1, t608_1, t759_1, t239_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 14 tips and 13 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t321_1, t29_1, t420_1, t687_1, t549_1, t365_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 14 tips and 13 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t384_1, t653_1, t852_1, t774_1, t982_1, t827_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 11 tips and 10 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t1023_1, t19_1, t339_1, t581_1, t874_1, t108_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 10 tips and 9 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t858_1, t267_1, t1064_1, t911_1, t511_1, t580_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 12 tips and 11 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t657_1, t605_1, t595_1, t898_1, t738_1, t1028_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 11 tips and 10 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t898_1, t170_1, t674_1, t449_1, t298_1, t273_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 14 tips and 13 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t889_1, t2_1, t960_1, t942_1, t931_1, t899_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span>
<span class="co">## </span>
<span class="co">## [[1]]</span>
<span class="co">## </span>
<span class="co">## Phylogenetic tree with 13 tips and 12 internal nodes.</span>
<span class="co">## </span>
<span class="co">## Tip labels:</span>
<span class="co">##   t560_1, t634_1, t268_1, t488_1, t1024_1, t509_1, ...</span>
<span class="co">## </span>
<span class="co">## Rooted; includes branch lengths.</span></code></pre>
<p>In the above code we have created a loop using ‘while’ so that we do not need to enter the values manually. Then we have created the variable tree which is a vector to store our data from simulation.</p>
<p>It returns a list of SAtree objects as the simulated trees may contain sampled ancestors as tips with zero-length branches.</p>
<p>We can check the simulated data value using trees[[n]]$root.edge function.</p>
<p>For Example:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">trees</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">root.edge</span></code></pre></div>
<pre><code><span class="co">## [1] 0.0822745</span></code></pre>
<p>It returns the simulated value from first tree simulated. We can do the same for other 19.</p>
<p>If we want to create an object to store the simulated data, we can create a for loop which collects the data at once for all 20 trees.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">i</span> <span class="op">=</span> <span class="fl">1</span>
<span class="va">simulated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span><span class="op">{</span>
  <span class="va">simulated</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">trees</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">root.edge</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>We also need to create some variable to put our emperical value which is the origin time from our given dataset, and calculate mean for both.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">emperical_data</span> <span class="op">&lt;-</span> <span class="va">ants</span><span class="op">$</span><span class="va">origin_time</span>
<span class="va">meane</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">emperical_data</span><span class="op">)</span>
<span class="va">means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">simulated</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="function-treeplot">Function: treeplot<a class="anchor" aria-label="anchor" href="#function-treeplot"></a>
</h2>
<p>This function plots a strati graphic range representation of the tree and fossil samples using rangeplot.asymmetric function. It assumes that all speciation events are asymmetric. A strati graphic range represents the interval of time between the first and last appearances of a fossilized species. Thus, this range typically represents multiple fossil specimens observed at different times along a single lineage.</p>
<p>#Working example:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/treeplot.html">treeplot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<pre><code><span class="co">## NULL</span></code></pre>
<p>The tips in the resulting SAtree object represent extinction events.</p>
<p>Now, lets create a loop for this function that gives the plot for all the simulated data at once.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">i</span> <span class="op">=</span> <span class="fl">1</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span> <span class="op">{</span>
<span class="fu">BaruwalRPackage</span><span class="fu">::</span><span class="fu"><a href="../reference/treeplot.html">treeplot</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-14-1.png" width="700"><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-14-2.png" width="700"><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-14-3.png" width="700"><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-14-4.png" width="700"><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-14-5.png" width="700"><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-14-6.png" width="700"><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-14-7.png" width="700"><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-14-8.png" width="700"><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-14-9.png" width="700"><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-14-10.png" width="700"><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-14-11.png" width="700"><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-14-12.png" width="700"><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-14-13.png" width="700"><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-14-14.png" width="700"><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-14-15.png" width="700"><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-14-16.png" width="700"><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-14-17.png" width="700"><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-14-18.png" width="700"><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-14-19.png" width="700"><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-14-20.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="function-comparision">Function: comparision<a class="anchor" aria-label="anchor" href="#function-comparision"></a>
</h2>
<p>This function compares the simulated data with the emperical data using emperical mean. It returns the ggplot of simulated data against emperical mean. If the emperical test statistic value is very different from the simulated ones, our model is not doing a good job of replicating some aspect of the process that generated our data.</p>
<p>We can make a dataframe to keep the necessary data for our convenience:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">simulated</span>, <span class="va">emperical_data</span>, <span class="va">meane</span>, <span class="va">means</span><span class="op">)</span></code></pre></div>
<p>#Working example:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/comparision.html">comparision</a></span><span class="op">(</span>datasdf <span class="op">=</span> <span class="va">datas</span><span class="op">)</span></code></pre></div>
<p><img src="Baruwal_R_Package_Tutorial_files/figure-html/unnamed-chunk-16-1.png" width="700"> It returns a curve for the simulated data and a dotted line for emperical mean.</p>
</div>
<div class="section level2">
<h2 id="function-effect_size">Function: effect_size<a class="anchor" aria-label="anchor" href="#function-effect_size"></a>
</h2>
<p>This function calculate the difference between the emperical test statistic value and the median of simulated test statistic divided by the standard deviation of simulated test statistic. It shows how many standard deviations away from the median is the observed value.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/effect_size.html">effect_size</a></span><span class="op">(</span>datasdf <span class="op">=</span> <span class="va">datas</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.9358944</span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Simran Baruwal.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
